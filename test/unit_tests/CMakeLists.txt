
SET(UNITTESTER_DIR ${CMAKE_CURRENT_SOURCE_DIR} PARENT_SCOPE)

macro(cxx_unit_test targetname useomp usecuda targetsrcs)

ENABLE_LANGUAGE(CXX)

INCLUDE_DIRECTORIES("${UTILS_KOKKOS_DIR}/core/src" "${UNITTESTER_DIR}")
SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++11 -DKOKKOS_HAVE_CXX11=1")

IF(useomp)
  SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -DKOKKOS_HAVE_OPENMP=1")
ENDIF()

IF(usecuda)
  SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -DKOKKOS_HAVE_CUDA=1")
ENDIF()

ADD_EXECUTABLE(targetname ${UNITTESTER_DIR}/tester.cpp ${targetsrcs})

endmacro(cxx_unit_test)
